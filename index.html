<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Paddle.js OCR Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      background: #f7f8fa;
      color: #333;
      text-align: center;
    }

    h1 {
      color: #0077ff;
    }

    #upload {
      margin: 20px 0;
    }

    #canvas {
      border: 1px solid #ccc;
      margin-top: 20px;
      max-width: 90%;
    }

    #output {
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      margin-top: 20px;
      text-align: left;
      white-space: pre-wrap;
      word-wrap: break-word;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .loading {
      color: #666;
      font-style: italic;
    }
  </style>
</head>
<body>
  <h1>Paddle.js OCR ‚Äî Extract Text from Images</h1>
  <p>Upload an image to extract text directly in your browser (no server needed!)</p>

  <input type="file" id="upload" accept="image/*">
  <div id="status"></div>
  <canvas id="canvas"></canvas>
  <div id="output"></div>

  <!-- Import Paddle.js OCR -->
  <script type="module">
    import * as ocr from "https://unpkg.com/@paddlejs-models/ocr?module";

    const upload = document.getElementById("upload");
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");
    const output = document.getElementById("output");
    const status = document.getElementById("status");

    upload.addEventListener("change", async (e) => {
      const file = e.target.files[0];
      if (!file) return;

      output.innerText = "";
      status.innerHTML = "<p class='loading'>Loading OCR model... please wait ‚è≥</p>";

      // Load model once
      await ocr.load();
      status.innerHTML = "<p class='loading'>Processing image...</p>";

      // Load image
      const img = new Image();
      img.src = URL.createObjectURL(file);
      await img.decode();

      // Adjust canvas
      canvas.width = img.width;
      canvas.height = img.height;
      ctx.drawImage(img, 0, 0);

      // Run OCR
      const result = await ocr.recognize(img);

      status.innerHTML = "<p>‚úÖ OCR complete!</p>";

      // Draw boxes
      ctx.lineWidth = 2;
      ctx.strokeStyle = "red";
      result.boxes.forEach(box => {
        ctx.beginPath();
        ctx.moveTo(box[0], box[1]);
        for (let i = 2; i < box.length; i += 2) {
          ctx.lineTo(box[i], box[i + 1]);
        }
        ctx.closePath();
        ctx.stroke();
      });

      // Show text
      let textResult = "";
      if (result.texts && result.texts.length) {
        textResult = result.texts.map((t, i) => `${i + 1}. ${t}`).join("\n");
      } else {
        textResult = "No text detected üòï";
      }
      output.innerText = textResult;
    });
  </script>
</body>
</html>
